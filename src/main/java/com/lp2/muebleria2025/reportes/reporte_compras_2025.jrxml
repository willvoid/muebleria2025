<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 7.0.1.final using JasperReports Library version 5.1.0  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="reporte_compras" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="d0ba1e6a-8843-4068-aa33-ed96b82b3270">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="New Data Adapter"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<subDataset name="reporte_compras" uuid="524527e0-e191-4175-bf94-d7731d0c695e">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="New Data Adapter"/>
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<queryString>
			<![CDATA[select idcompras, fecha_compra, nombre, descripcion, cantidad, precio_compra,subtotal 
from compras co
inner join detalle_compras d
on co.idcompras = d.compra_id
inner join proveedores pr
on pr.id = co.idproveedor
order by idcompras asc]]>
		</queryString>
		<field name="idcompras" class="java.lang.Integer">
			<property name="com.jaspersoft.studio.field.name" value="idcompras"/>
			<property name="com.jaspersoft.studio.field.label" value="idcompras"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="compras"/>
		</field>
		<field name="fecha_compra" class="java.sql.Date">
			<property name="com.jaspersoft.studio.field.name" value="fecha_compra"/>
			<property name="com.jaspersoft.studio.field.label" value="fecha_compra"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="compras"/>
		</field>
		<field name="nombre" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="nombre"/>
			<property name="com.jaspersoft.studio.field.label" value="nombre"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="proveedores"/>
		</field>
		<field name="descripcion" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="descripcion"/>
			<property name="com.jaspersoft.studio.field.label" value="descripcion"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="detalle_compras"/>
		</field>
		<field name="cantidad" class="java.lang.Integer">
			<property name="com.jaspersoft.studio.field.name" value="cantidad"/>
			<property name="com.jaspersoft.studio.field.label" value="cantidad"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="detalle_compras"/>
		</field>
		<field name="precio_compra" class="java.lang.Integer">
			<property name="com.jaspersoft.studio.field.name" value="precio_compra"/>
			<property name="com.jaspersoft.studio.field.label" value="precio_compra"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="detalle_compras"/>
		</field>
		<field name="subtotal" class="java.lang.Integer">
			<property name="com.jaspersoft.studio.field.name" value="subtotal"/>
			<property name="com.jaspersoft.studio.field.label" value="subtotal"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="detalle_compras"/>
		</field>
	</subDataset>
	<parameter name="desde" class="java.sql.Date"/>
	<parameter name="hasta" class="java.sql.Date"/>
	<queryString>
		<![CDATA[SELECT 
    c.idcompras, c.fecha_compra,
    p.nombre,
    STRING_AGG(dc.descripcion || '  x  ' || dc.cantidad, E'\n') AS descripcion_productos,
    SUM(dc.cantidad) AS cantidad_total, u.nombre || ' ' || u.apellido AS Usuario, c.total
FROM compras c
INNER JOIN detalle_compras dc ON c.idcompras = dc.compra_id
INNER JOIN proveedores p ON p.id = c.idproveedor
INNER JOIN usuario u ON u.id = idusuario
WHERE fecha_compra >= $P{desde} AND fecha_compra <=$P{hasta}
GROUP BY c.idcompras, p.nombre, u.nombre, u.apellido;]]>
	</queryString>
	<field name="idcompras" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="idcompras"/>
		<property name="com.jaspersoft.studio.field.label" value="idcompras"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="compras"/>
	</field>
	<field name="fecha_compra" class="java.sql.Date">
		<property name="com.jaspersoft.studio.field.name" value="fecha_compra"/>
		<property name="com.jaspersoft.studio.field.label" value="fecha_compra"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="compras"/>
	</field>
	<field name="nombre" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="nombre"/>
		<property name="com.jaspersoft.studio.field.label" value="nombre"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="proveedores"/>
	</field>
	<field name="descripcion_productos" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="descripcion_productos"/>
		<property name="com.jaspersoft.studio.field.label" value="descripcion_productos"/>
	</field>
	<field name="cantidad_total" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="cantidad_total"/>
		<property name="com.jaspersoft.studio.field.label" value="cantidad_total"/>
	</field>
	<field name="usuario" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="usuario"/>
		<property name="com.jaspersoft.studio.field.label" value="usuario"/>
	</field>
	<field name="total" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="total"/>
		<property name="com.jaspersoft.studio.field.label" value="total"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="compras"/>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="120" splitType="Stretch">
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<textField pattern="MMMMM dd, yyyy">
				<reportElement x="460" y="0" width="100" height="30" uuid="72f884f0-4ab3-4c8e-b0ca-9e2347a97437"/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField pattern="HH:mm">
				<reportElement x="460" y="12" width="100" height="30" uuid="aac0433d-c78f-4ce0-bdfc-d1b900dcf351"/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="366" y="-1" width="100" height="30" uuid="fdfc4be3-26fd-462e-8438-3af9788fc7f9"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha y hora de impresión:]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="80" splitType="Stretch">
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<staticText>
				<reportElement mode="Opaque" x="-20" y="25" width="595" height="30" forecolor="#FFFFFF" backcolor="#D13F2D" uuid="a92e82cf-bcc2-4ab2-a0d0-2da616de0c09"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Eras Bold ITC" size="15" isBold="true"/>
				</textElement>
				<text><![CDATA[Reporte de Compras - VG Mueblería]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="82">
			<staticText>
				<reportElement mode="Opaque" x="-15" y="47" width="30" height="30" forecolor="#FFFFFF" backcolor="#000203" uuid="cc46bf17-6d56-42ac-baa0-fd4c027155ff"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[N°]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="15" y="47" width="45" height="30" forecolor="#FFFFFF" backcolor="#000203" uuid="f9383a60-7496-46bc-8539-b63c021f211a"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="60" y="47" width="122" height="30" forecolor="#FFFFFF" backcolor="#000203" uuid="b0fc7cee-1089-4756-b28a-3727c3011152"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Proveedor]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="182" y="47" width="214" height="30" forecolor="#FFFFFF" backcolor="#000203" uuid="4e83a2e9-a87c-42ee-8ba1-5f957cbfe5b4"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Producto]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="519" y="47" width="51" height="30" forecolor="#FFFFFF" backcolor="#000203" uuid="833aa71b-00b0-42b9-96ed-2d06a8203202"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Total Compra]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="396" y="47" width="123" height="30" forecolor="#FFFFFF" backcolor="#000203" uuid="e234c6f4-b810-45d0-8591-62f2a1ae549a"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Usuario]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="74" splitType="Stretch">
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<line>
				<reportElement x="-10" y="66" width="575" height="1" uuid="f557b7f0-eedd-4e35-9c91-e6523e1e6e6a">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
			</line>
			<textField>
				<reportElement x="-15" y="0" width="25" height="30" uuid="6f057d3b-46dc-486f-8729-47e3358f3a02">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="8143dd6c-e154-4f04-9797-1ef2e0029a80"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{idcompras}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="15" y="5" width="50" height="20" uuid="590d65e6-5071-4331-8f51-322b10d54494">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="bb313515-4924-41ab-9707-2d0304f34638"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{fecha_compra}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="80" y="0" width="100" height="30" uuid="9f08365e-2058-48ec-9ad2-41295bb96b1c">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="812fd94f-3d1e-4330-b1d6-3e7e6f8af46c"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{nombre}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="182" y="0" width="214" height="30" uuid="c6f5dfff-b637-42f4-be26-834f5547f794">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="c6960df3-9b5b-4ef7-a7c8-4aec8662a867"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{descripcion_productos}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="396" y="0" width="123" height="30" uuid="dfba78bc-0cdd-4dde-8703-967dcb09b0b7">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="5f3f018c-b80f-4752-bdc5-2f06aa2b95d8"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{usuario}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="519" y="0" width="51" height="30" uuid="cbc4eff0-5647-4e0d-851b-e4eccdb97aa6">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="aac7a13c-d2d2-45d0-9691-02a2118dbb43"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
